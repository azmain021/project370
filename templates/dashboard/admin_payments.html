{% extends "base.html" %}
{% block title %}Admin â€“ Payments{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-8 px-4">
  <h1 class="text-2xl font-bold mb-6">Manage Payments</h1>

  <!-- Pending Payments Section -->
  <div class="bg-white shadow rounded-lg p-4 mb-8">
    <h2 class="text-lg font-semibold mb-3">Pending Payments</h2>

    {% if pending_payments %}
      <table class="w-full text-sm">
        <thead class="border-b text-left text-gray-500">
          <tr>
            <th class="py-2">ID</th>
            <th class="py-2">Property</th>
            <th class="py-2">Tenant</th>
            <th class="py-2">Amount</th>
            <th class="py-2">Action</th>
          </tr>
        </thead>
        <tbody>
        {% for p in pending_payments %}
          <tr class="border-b last:border-0">
            <td class="py-2">#{{ p.id }}</td>
            <td class="py-2">{{ p.booking.property.title }}</td>
            <td class="py-2">{{ p.booking.tenant.username }}</td>
            <td class="py-2">{{ p.amount }}</td>
            <td class="py-2">
              <form method="post">
                {% csrf_token %}
                <input type="hidden" name="payment_id" value="{{ p.id }}">
                <button
                  class="px-3 py-1 text-xs rounded bg-green-600 text-white hover:bg-green-700"
                >
                  Approve
                </button>
              </form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-gray-500 text-sm">No pending payments.</p>
    {% endif %}
  </div>

  <!-- Approved Payments -->
  <div class="bg-white shadow rounded-lg p-4">
    <h2 class="text-lg font-semibold mb-3">Recently Approved</h2>

    {% if approved_payments %}
      <table class="w-full text-sm">
        <thead class="border-b text-left text-gray-500">
          <tr>
            <th class="py-2">ID</th>
            <th class="py-2">Booking</th>
            <th class="py-2">Amount</th>
            <th class="py-2">Platform Cut</th>
            <th class="py-2">Seller Amount</th>
            <th class="py-2">Approved By</th>
          </tr>
        </thead>

        <tbody>
        {% for p in approved_payments %}
          <tr class="border-b last:border-0">
            <td class="py-2">#{{ p.id }}</td>
            <td class="py-2">#{{ p.booking.id }}</td>
            <td class="py-2">{{ p.amount }}</td>
            <td class="py-2">{{ p.platform_cut }}</td>
            <td class="py-2">{{ p.seller_amount }}</td>
            <td class="py-2">{{ p.approved_by_admin.username }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-gray-500 text-sm">No approvals yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
